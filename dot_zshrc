# Enable Powerlevel10k instant prompt. Should stay close to the top of ~/.zshrc.
# Initialization code that may require console input (password prompts, [y/n]
# confirmations, etc.) must go above this block; everything else may go below.
if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi

export NIX_PREFIX="$HOME/.nix-profile"

export PYENV_ROOT="$HOME/.pyenv"
[[ -d $PYENV_ROOT/bin ]] && export PATH="$PYENV_ROOT/bin:$PATH"
eval "$(pyenv init - zsh)"

# check if we did a :term command in neovim
is_nvim_term() {
    parent_process=$(ps -o comm= -p $PPID)
    if [[ $parent_process == *"nvim"* ]]; then
        return 0  # Return success (true)
    else
        return 1  # Return failure (false)
    fi
}
if [ -n "$WEZTERM_EXECUTABLE" ]; then
  export TERM=wezterm
fi
# setup term before loading tmux
# for undercurls
if [ -n "$TMUX" ]; then
    export TERM="tmux-256color"
fi


# source .nix.zshrc
if [ -f "$HOME/.nix.zsh" ]; then
    source "$HOME/.nix.zsh"
fi
# nix home-manager setup
if [ -f "$HOME/.nix-profile/etc/profile.d/hm-session-vars.sh" ]; then
    source "$HOME/.nix-profile/etc/profile.d/hm-session-vars.sh"
fi

HISTSIZE=10000
HISTFILESIZE=20000

# compdef init
autoload -U compinit && compinit -u

# jujutsu completion
source <(jj util completion zsh)


# Fix starship load wrapping issue
export LC_ALL=en_US.UTF-8

export NVM_DIR="$HOME/.nvm"
  [ -s "/opt/homebrew/opt/nvm/nvm.sh" ] && \. "/opt/homebrew/opt/nvm/nvm.sh"  # This loads nvm
 # [ -s "/opt/homebrew/opt/nvm/etc/bash_completion.d/nvm" ] && \. "/opt/homebrew/opt/nvm/etc/bash_completion.d/nvm"  # This loads nvm bash_completion

# set java jdk to homebrew installation
# export JAVA_HOME=/opt/homebrew/opt/openjdk/

# colors
export CLICOLOR=1


test -f ~/.work-zshrc && source ~/.work-zshrc # 2> /dev/null

# setup kubectl
if command -v kubectl &> /dev/null; then
    # kubectl aliases
    alias k="kubectl"
    alias kctx="kubectl ctx"
    alias kns="kubectl ns"
    # Load the kubectl completion code for zsh[1] into the current shell
    source <(kubectl completion zsh)
fi

#nvimdiff
alias nvimdiff="nvim -d"

# edit this .zshrc file
alias zshconfig="nvim ~/.zshrc"

# open ~/.config/nvimo
alias nconfig="(cd ~/.config/nvim; nvim)"

# reload this zshfile
alias zshreload="source ~/.zshrc"


alias standups="nvim ~/standups.md"
alias scratch="nvim ~/scratch.md"



# set ctype locale to C
export LC_CTYPE="C"

# fix to iterm nav hotkeys
bindkey "\e\e[D" backward-word
bindkey "\e\e[C" forward-word
# bindkey "^[[24;2~" f12

#krew setup
export PATH="${PATH}:${HOME}/.krew/bin"

function get-millis(){
  date +%s000
}


if command -v goenv &> /dev/null; then
    # golang
    export GOENV_ROOT="$HOME/.goenv"
    export PATH="$GOENV_ROOT/bin:$PATH"
    eval "$(goenv init -)"
    export PATH="$GOROOT/bin:$PATH"
    export PATH="$PATH:$GOPATH/bin"
    export GOBIN="$GOENV_ROOT/bin"
fi

# setup visaul and editor
if command -v nvim &> /dev/null; then
    export EDITOR=nvim
fi

if command -v bat &> /dev/null; then
    export VISUAL=nvim
fi

[[ -s "/Users/vali/.gvm/scripts/gvm" ]] && source "/Users/vali/.gvm/scripts/gvm"

# zprof

# opencode
export PATH=/Users/danielvallesteros/.opencode/bin:$PATH
